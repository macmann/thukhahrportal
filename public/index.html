<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Leave Management | Brillar</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700&display=swap">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />
  <link rel="stylesheet" href="material-theme.css">
  <style>
    /* Active Employees – card layout */

    .active-employees-section {
      margin-top: 24px;
    }

    .active-employees-header {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: flex-end;
      gap: 12px;
      margin-bottom: 16px;
    }

    .active-employees-title {
      margin: 0;
      font-size: 20px;
      font-weight: 600;
      color: #111827;
    }

    .active-employees-subtitle {
      margin: 4px 0 0;
      font-size: 12px;
      color: #6b7280;
    }

    .employee-search-wrapper {
      min-width: 220px;
    }

    .employee-search-label {
      display: block;
      margin-bottom: 4px;
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: #6b7280;
    }

    .employee-search-input-wrapper {
      position: relative;
    }

    .employee-search-icon {
      position: absolute;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 13px;
      color: #9ca3af;
      pointer-events: none;
    }

    .employee-search-input {
      width: 100%;
      padding: 7px 10px 7px 28px;
      font-size: 13px;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      background-color: #ffffff;
      color: #111827;
    }

    .employee-search-input::placeholder {
      color: #9ca3af;
    }

    .employee-search-input:focus {
      outline: none;
      border-color: #4f46e5;
      box-shadow: 0 0 0 1px #4f46e5;
    }

    .employee-cards {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    @media (min-width: 768px) {
      .employee-cards {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (min-width: 1100px) {
      .employee-cards {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .employee-card {
      background-color: #ffffff;
      border-radius: 14px;
      padding: 14px 16px;
      border: 1px solid #e5e7eb;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.06);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      gap: 10px;
    }

    .employee-card-top {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 10px;
    }

    .employee-name {
      margin: 0;
      font-size: 14px;
      font-weight: 600;
      color: #111827;
    }

    .employee-role {
      margin: 2px 0 0;
      font-size: 12px;
      color: #6b7280;
    }

    .employee-status-dot {
      width: 10px;
      height: 10px;
      border-radius: 9999px;
      background-color: #10b981;
      margin-top: 2px;
    }

    .employee-card-middle {
      display: flex;
      align-items: flex-end;
      justify-content: space-between;
      gap: 10px;
    }

    .employee-salary-group {
      flex: 1;
    }

    .employee-salary-label {
      display: block;
      margin-bottom: 4px;
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: #6b7280;
    }

    .employee-salary-input-wrapper {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 10px;
      border: 1px solid #d1d5db;
      background-color: #f9fafb;
    }

    .employee-salary-icon {
      font-size: 15px;
      color: #f59e0b;
    }

    .employee-salary-input {
      flex: 1;
      border: none;
      outline: none;
      font-size: 13px;
      background-color: transparent;
      color: #111827;
    }

    .employee-salary-input::-webkit-outer-spin-button,
    .employee-salary-input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    .employee-salary-input[type="number"] {
      -moz-appearance: textfield;
    }

    .employee-salary-currency {
      font-size: 11px;
      font-weight: 600;
      color: #6b7280;
    }

    .employee-save-button {
      padding: 7px 14px;
      border-radius: 9999px;
      border: none;
      background-color: #4f46e5;
      color: #ffffff;
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      white-space: nowrap;
      box-shadow: 0 4px 10px rgba(79, 70, 229, 0.35);
    }

    .employee-save-button:hover {
      background-color: #4338ca;
    }

    .employee-save-button:active {
      background-color: #3730a3;
    }

    .employee-save-button:disabled {
      opacity: 0.6;
      cursor: default;
      box-shadow: none;
    }

    .employee-updated {
      margin: 0;
      font-size: 11px;
      color: #9ca3af;
    }

    /* Payroll Summary table – layout and styling */

    .payroll-summary-container {
      margin-top: 16px;
    }

    .payroll-summary-table-wrapper {
      margin-top: 8px;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      background-color: #ffffff;
      max-height: 480px;        /* table body scrolls when taller */
      overflow-y: auto;
      overflow-x: auto;
    }

    .payroll-summary-table-wrapper::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    .payroll-summary-table-wrapper::-webkit-scrollbar-thumb {
      background-color: #cbd5e1;
      border-radius: 999px;
    }

    .payroll-summary-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
      color: #111827;
      min-width: 600px;
    }

    .payroll-summary-table thead th {
      position: sticky;
      top: 0;
      z-index: 1;
      background-color: #f3f4f6;
      text-align: left;
      padding: 10px 12px;
      font-weight: 600;
      border-bottom: 1px solid #e5e7eb;
      white-space: nowrap;
    }

    .payroll-summary-table tbody td {
      padding: 8px 12px;
      border-bottom: 1px solid #f3f4f6;
    }

    .payroll-summary-table tbody tr:nth-child(odd) {
      background-color: #ffffff;
    }

    .payroll-summary-table tbody tr:nth-child(even) {
      background-color: #f9fafb;
    }

    .payroll-summary-table tbody tr:hover {
      background-color: #eef2ff;
    }

    /* Right-align salary column (2nd column) */
    .payroll-summary-table tbody td:nth-child(2) {
      text-align: right;
      font-variant-numeric: tabular-nums;
    }

    /* Bank account columns – ellipsis if too long */
    .payroll-summary-table tbody td:nth-child(3),
    .payroll-summary-table tbody td:nth-child(4) {
      max-width: 260px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
  </style>
</head>
<body class="app-shell">
  <!-- Login Experience -->
  <div id="loginPage" class="login-view">
    <div class="login-card">
      <img src="logo.png" alt="Brillar Logo" class="brand-logo">
      <div>
        <h1 class="login-title">Brillar Leave Portal</h1>
        <p class="login-subtitle">Sign in to request leave, review approvals, and keep your team informed.</p>
      </div>
      <form id="loginForm" class="form-stack">
        <div class="md-field">
          <label class="md-label" for="loginEmail">Work Email</label>
          <div class="md-input-wrapper">
            <span class="material-symbols-rounded">mail</span>
            <input id="loginEmail" name="email" type="email" placeholder="you@brillar.io" required class="md-input">
          </div>
        </div>
        <div class="md-field">
          <label class="md-label" for="loginPassword">Password</label>
          <div class="md-input-wrapper">
            <span class="material-symbols-rounded">lock</span>
            <input id="loginPassword" name="password" type="password" placeholder="Enter your password" required class="md-input">
          </div>
        </div>
        <button type="submit" class="md-button md-button--filled">
          <span class="material-symbols-rounded">login</span>
          Sign In
        </button>
        <button id="msLoginBtn" type="button" class="md-button md-button--outlined">
          <span class="material-symbols-rounded">account_circle</span>
          Sign in with Microsoft 365
        </button>
        <div id="loginError" class="form-error hidden"></div>
      </form>
    </div>
  </div>

  <!-- Main Application -->
  <div id="mainApp" class="hidden app-container">
    <header class="top-app-bar">
      <div class="brand-cluster">
        <img src="https://static.wixstatic.com/media/34647d_4924e46631c3463abed06f9e3147eba3~mv2.png" alt="Brillar Logo">
        <div class="brand-text">
          <span class="brand-title">Brillar Leave Management</span>
          <span class="brand-subtitle">Modern, people-first HR experiences</span>
        </div>
      </div>
      <div class="app-actions">
        <button id="changePassBtn" type="button" class="md-button md-button--tonal hidden">
          <span class="material-symbols-rounded">key</span>
          Change Password
        </button>
        <button id="logoutBtn" type="button" onclick="logout()" class="md-button md-button--outlined hidden">
          <span class="material-symbols-rounded">logout</span>
          Logout
        </button>
      </div>
    </header>

    <nav class="tab-bar">
      <div class="tab-section tab-section--primary">
        <button id="tabProfile" class="tab-button hidden">
          <span class="material-symbols-rounded">account_circle</span>
          <span>My Profile</span>
        </button>
        <button id="tabPortal" class="tab-button active-tab">
          <span class="material-symbols-rounded">event_available</span>
          <span>Leave Portal</span>
        </button>
      </div>

      <div class="tab-section tab-section--groups">
        <div class="tab-group" data-tab-group>
          <button type="button" class="tab-group-toggle" data-tab-group-toggle aria-expanded="false">
            <span class="material-symbols-rounded">handshake</span>
            <span class="tab-group-label">Team Operations</span>
            <span class="material-symbols-rounded tab-group-caret">expand_more</span>
          </button>
          <div class="tab-group-menu" data-tab-group-menu>
            <button id="tabManage" class="tab-button">
              <span class="material-symbols-rounded">group</span>
              <span>Employee Management</span>
            </button>
            <button id="tabRecruitment" class="tab-button hidden">
              <span class="material-symbols-rounded">work_history</span>
              <span>Recruitment</span>
            </button>
            <button id="tabManagerApps" class="tab-button hidden">
              <span class="material-symbols-rounded">inbox</span>
              <span>Leave Applications</span>
            </button>
          </div>
        </div>

        <div class="tab-group" data-tab-group>
          <button type="button" class="tab-group-toggle" data-tab-group-toggle aria-expanded="false">
            <span class="material-symbols-rounded">insights</span>
            <span class="tab-group-label">Insights &amp; Admin</span>
            <span class="material-symbols-rounded tab-group-caret">expand_more</span>
          </button>
          <div class="tab-group-menu" data-tab-group-menu>
            <button id="tabLeaveReport" class="tab-button hidden">
              <span class="material-symbols-rounded">monitoring</span>
              <span>Leave Report</span>
            </button>
            <button id="tabSettings" class="tab-button hidden">
              <span class="material-symbols-rounded">settings</span>
              <span>Settings</span>
            </button>
            <button id="tabFinance" class="tab-button hidden">
              <span class="material-symbols-rounded">account_balance</span>
              <span>Finance</span>
            </button>
          </div>
        </div>
      </div>
    </nav>

    <main class="content-area">
      <!-- Employee Profile Panel -->
      <section id="profilePanel" class="panel hidden">
        <div class="panel-header">
          <h2 class="panel-title">
            <span class="material-symbols-rounded">account_circle</span>
            My Profile
          </h2>
          <p class="panel-subtitle">Review your personal information, update contact details, and keep emergency information accurate.</p>
        </div>

        <div class="card-grid profile-summary-grid">
          <div class="md-card">
            <div class="card-title">
              <span class="material-symbols-rounded">badge</span>
              Profile Overview
            </div>
            <dl class="profile-summary-list">
              <div class="profile-summary-item">
                <dt>Name</dt>
                <dd id="profileSummaryName">-</dd>
              </div>
              <div class="profile-summary-item">
                <dt>Work Email</dt>
                <dd id="profileSummaryEmail">-</dd>
              </div>
              <div class="profile-summary-item">
                <dt>Title</dt>
                <dd id="profileSummaryTitle">-</dd>
              </div>
              <div class="profile-summary-item">
                <dt>Department</dt>
                <dd id="profileSummaryDepartment">-</dd>
              </div>
              <div class="profile-summary-item">
                <dt>Reporting Manager</dt>
                <dd id="profileSummaryManager">-</dd>
              </div>
              <div class="profile-summary-item">
                <dt>Status</dt>
                <dd id="profileSummaryStatus">-</dd>
              </div>
            </dl>
          </div>

          <div class="md-card">
            <div class="card-title">
              <span class="material-symbols-rounded">account_balance_wallet</span>
              Leave Balances
            </div>
            <div id="profileLeaveBalances" class="balance-chips profile-balance-chips">
              <div class="balance-chip chip-annual">
                <span class="material-symbols-rounded">beach_access</span>
                <div>
                  <span class="label">Annual</span>
                  <strong id="profileBalAnnual">-</strong><span class="unit">days</span>
                </div>
              </div>
              <div class="balance-chip chip-casual">
                <span class="material-symbols-rounded">sunny</span>
                <div>
                  <span class="label">Casual</span>
                  <strong id="profileBalCasual">-</strong><span class="unit">days</span>
                </div>
              </div>
              <div class="balance-chip chip-medical">
                <span class="material-symbols-rounded">medical_information</span>
                <div>
                  <span class="label">Medical</span>
                  <strong id="profileBalMedical">-</strong><span class="unit">days</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div id="profileGlobalFeedback" class="profile-feedback hidden"></div>

        <div id="profileSections" class="profile-section-grid">
          <div class="md-card">
            <div class="card-title">
              <span class="material-symbols-rounded">info</span>
              Profile Details
            </div>
            <p class="text-muted" style="font-style: italic;">Loading profile information...</p>
          </div>
        </div>
      </section>

      <!-- Leave Portal Panel -->
      <section id="portalPanel" class="panel">
        <div class="panel-header">
          <h2 class="panel-title">
            <span class="material-symbols-rounded">widgets</span>
            Leave Portal
          </h2>
          <p class="panel-subtitle">Submit leave requests, review balances, and track recent activity at a glance.</p>
        </div>

        <div class="card-grid">
          <div class="md-card">
            <div class="card-title">
              <span class="material-symbols-rounded">badge</span>
              Select Employee
            </div>
            <div class="card-subtitle">Choose a colleague to surface their balances and manage applications.</div>
            <div class="md-field">
              <label class="md-label" for="employeeSelect">Employee</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">person</span>
                <select id="employeeSelect" class="md-select"></select>
              </div>
            </div>
          </div>

          <div class="md-card">
            <div class="card-title">
              <span class="material-symbols-rounded">account_balance_wallet</span>
              Current Leave Balance
            </div>
            <div id="balanceDisplay" class="balance-chips">
              <div class="balance-chip chip-annual">
                <span class="material-symbols-rounded">beach_access</span>
                <div>
                  <span class="label">Annual</span>
                  <strong id="balAnnual">-</strong><span class="unit">days</span>
                </div>
              </div>
              <div class="balance-chip chip-casual">
                <span class="material-symbols-rounded">sunny</span>
                <div>
                  <span class="label">Casual</span>
                  <strong id="balCasual">-</strong><span class="unit">days</span>
                </div>
              </div>
              <div class="balance-chip chip-medical">
                <span class="material-symbols-rounded">medical_information</span>
                <div>
                  <span class="label">Medical</span>
                  <strong id="balMedical">-</strong><span class="unit">days</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="md-card">
          <div class="card-title">
            <span class="material-symbols-rounded">calendar_month</span>
            Apply for Leave
          </div>
          <form id="applyForm" class="form-grid">
            <div class="md-field">
              <label class="md-label" for="type">Leave Type</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">category</span>
                <select id="type" name="type" class="md-select"></select>
              </div>
            </div>
            <div class="md-field">
              <label class="md-label" for="from">From</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">event</span>
                <input type="date" id="from" required class="md-input">
              </div>
            </div>
            <div class="md-field">
              <label class="md-label" for="to">To</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">event</span>
                <input type="date" id="to" required class="md-input">
              </div>
            </div>
            <div class="md-field checkbox-line">
              <input type="checkbox" id="halfDay" onchange="toggleHalfDayPeriod()">
              <label for="halfDay" class="md-label">Half Day</label>
              <select id="halfDayPeriod" class="md-select hidden">
                <option value="AM">AM</option>
                <option value="PM">PM</option>
              </select>
            </div>
            <button type="submit" class="md-button md-button--filled">
              <span class="material-symbols-rounded">send</span>
              Submit Application
            </button>
          </form>
        </div>

        <div class="md-card">
          <div class="card-title">
            <span class="material-symbols-rounded">festival</span>
            Upcoming Holidays
          </div>
          <div class="card-subtitle">Plan around company holidays when submitting leave applications.</div>
          <div id="holidayHighlights" class="holiday-preview-list">
            <p class="text-muted" style="font-style: italic;">Loading holidays...</p>
          </div>
        </div>

        <div id="reasonModal" class="modal-backdrop hidden">
          <div class="modal-card">
            <button type="button" id="modalCloseBtn" class="modal-close material-symbols-rounded">close</button>
            <h3 class="modal-title">
              <span class="material-symbols-rounded">chat</span>
              Reason for Leave
            </h3>
            <form id="reasonForm" class="form-stack">
              <textarea id="reasonInput" class="md-textarea" placeholder="Add helpful context for your approver" required></textarea>
              <div class="modal-actions">
                <button type="submit" class="md-button md-button--filled md-button--small">
                  <span class="material-symbols-rounded">check_circle</span>
                  Submit
                </button>
              </div>
            </form>
          </div>
        </div>

        <div id="changePassModal" class="modal-backdrop hidden">
          <div class="modal-card">
            <button type="button" id="passModalClose" class="modal-close material-symbols-rounded">close</button>
            <h3 class="modal-title">
              <span class="material-symbols-rounded">key</span>
              Change Password
            </h3>
            <form id="changePassForm" class="form-stack">
              <div class="md-field">
                <label class="md-label" for="currentPassword">Current Password</label>
                <div class="md-input-wrapper">
                  <span class="material-symbols-rounded">lock_open</span>
                  <input type="password" id="currentPassword" required class="md-input">
                </div>
              </div>
              <div class="md-field">
                <label class="md-label" for="newPassword">New Password</label>
                <div class="md-input-wrapper">
                  <span class="material-symbols-rounded">password</span>
                  <input type="password" id="newPassword" required class="md-input">
                </div>
              </div>
              <div class="md-field">
                <label class="md-label" for="confirmPassword">Confirm Password</label>
                <div class="md-input-wrapper">
                  <span class="material-symbols-rounded">verified_user</span>
                  <input type="password" id="confirmPassword" required class="md-input">
                </div>
              </div>
              <div class="modal-actions">
                <button type="button" id="cancelPassChange" class="md-button md-button--text md-button--small">Cancel</button>
                <button type="submit" class="md-button md-button--filled md-button--small">
                  <span class="material-symbols-rounded">save</span>
                  Update
                </button>
              </div>
            </form>
          </div>
        </div>

        <div class="md-card">
          <div class="card-title">
            <span class="material-symbols-rounded">history</span>
            Previous Leave Applications
          </div>
          <div id="prevLeaves"></div>
        </div>
      </section>

      <!-- Employee Management Panel -->
      <section id="managePanel" class="panel hidden">
        <div class="panel-header">
          <h2 class="panel-title">
            <span class="material-symbols-rounded">supervisor_account</span>
            Manage Employees
          </h2>
          <p class="panel-subtitle">Keep employee records tidy, upload new team members, and adjust balances instantly.</p>
        </div>

        <div class="card-grid">
          <div class="md-card">
            <div class="card-title">
              <span class="material-symbols-rounded">diversity_3</span>
              Active Employees
            </div>
            <p class="card-subtitle">Monitor your roster and ensure everyone's details stay current.</p>
            <div class="balance-chip" style="background: rgba(16,200,84,0.12); color:#0f7b32;">
              <span class="material-symbols-rounded">groups</span>
              <div>
                <span class="label">Currently active</span>
                <strong id="activeCountNum">0</strong>
                <span class="unit">members</span>
              </div>
            </div>
          </div>
          <div class="md-card">
            <div class="card-title">
              <span class="material-symbols-rounded">upload_file</span>
              Quick Actions
            </div>
            <div class="list-card__actions" style="justify-content:flex-start;">
              <button id="csvUploadBtn" class="md-button md-button--outlined">
                <span class="material-symbols-rounded">cloud_upload</span>
                Upload Employees CSV
              </button>
              <button id="leaveCsvUploadBtn" class="md-button md-button--outlined">
                <span class="material-symbols-rounded">event_available</span>
                Upload Leave CSV
              </button>
              <button id="addEmployeeBtn" class="md-button md-button--filled">
                <span class="material-symbols-rounded">person_add</span>
                Add Employee
              </button>
              <input id="csvInput" type="file" accept=".csv" class="hidden">
              <input id="leaveCsvInput" type="file" accept=".csv" class="hidden">
            </div>
          </div>
        </div>

        <div class="md-card" style="overflow-x:auto;">
          <div class="table-toolbar">
            <div class="md-field table-search">
              <label class="md-label" for="empSearchInput">Search employees</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">search</span>
                <input id="empSearchInput" type="text" class="md-input" placeholder="Search name, role, status, etc." autocomplete="off" spellcheck="false">
              </div>
            </div>
          </div>
          <table id="empTable" class="data-table">
            <thead id="empTableHead"></thead>
            <tbody id="empTableBody"></tbody>
          </table>
        </div>

        <div
          id="empModal"
          class="modal-backdrop hidden"
          role="dialog"
          aria-modal="true"
          aria-labelledby="empModalTitle"
        >
          <div class="modal-card modal-card--wide employee-modal">
            <button type="button" id="empModalCloseBtn" class="modal-close material-symbols-rounded">close</button>
            <h3 id="empModalTitle" class="modal-title">Add Employee</h3>
            <form id="empModalForm" class="modal-body-scroll">
              <div id="empModalFields" class="employee-modal__fields"></div>
            </form>
            <div class="modal-actions">
              <button type="submit" form="empModalForm" class="md-button md-button--filled md-button--small">
                <span class="material-symbols-rounded">save</span>
                Save
              </button>
              <button type="button" id="empModalCancelBtn" class="md-button md-button--outlined md-button--small">Cancel</button>
            </div>
          </div>
        </div>
      </section>

      <!-- Recruitment Pipeline Panel -->
      <section id="recruitmentPanel" class="panel hidden">
        <div class="panel-header">
          <h2 class="panel-title">
            <span class="material-symbols-rounded">work_history</span>
            Recruitment Pipeline
          </h2>
          <p class="panel-subtitle">Open roles and monitor every candidate from first touch to hiring.</p>
        </div>

        <div class="card-grid card-grid--single">
          <div class="md-card">
            <div class="card-title">
              <span class="material-symbols-rounded">manage_search</span>
              Candidate Lookup
            </div>
            <p class="card-subtitle">Find applicants across every position to check their previous submissions.</p>
            <div class="md-field table-search">
              <label class="md-label" for="candidateSearchInput">Search candidates</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">search</span>
                <input id="candidateSearchInput" type="text" class="md-input" placeholder="Search by name or contact" autocomplete="off" spellcheck="false">
              </div>
            </div>
            <div id="candidateSearchResults" class="candidate-search-results text-muted">
              Start typing to look up existing applicants.
            </div>
          </div>
        </div>

        <div class="card-grid">
          <div class="md-card">
            <div class="card-title">
              <span class="material-symbols-rounded">playlist_add</span>
              Create Position
            </div>
            <p class="card-subtitle">Document new openings so your hiring team stays aligned.</p>
            <form id="positionForm" class="form-stack">
              <div class="md-field">
                <label class="md-label" for="positionTitle">Position title</label>
                <div class="md-input-wrapper">
                  <span class="material-symbols-rounded">badge</span>
                  <input id="positionTitle" name="title" type="text" class="md-input" placeholder="e.g., Senior Designer" required>
                </div>
              </div>
              <div class="md-field">
                <label class="md-label" for="positionDepartment">Department</label>
                <div class="md-input-wrapper">
                  <span class="material-symbols-rounded">business_center</span>
                  <input id="positionDepartment" name="department" type="text" class="md-input" placeholder="Optional">
                </div>
              </div>
              <div class="md-field">
                <label class="md-label" for="positionDescription">Description</label>
                <textarea id="positionDescription" name="description" class="md-textarea" rows="3" placeholder="Add role highlights or notes"></textarea>
              </div>
              <div class="form-actions">
                <button id="positionSubmitBtn" type="submit" class="md-button md-button--filled md-button--small">
                  <span id="positionSubmitIcon" class="material-symbols-rounded">save</span>
                  <span class="position-submit-label">Save Position</span>
                </button>
                <button id="positionCancelEditBtn" type="button" class="md-button md-button--text md-button--small hidden">
                  <span class="material-symbols-rounded">close</span>
                  Cancel Edit
                </button>
              </div>
            </form>
          </div>

          <div class="md-card">
            <div class="card-title">
              <span class="material-symbols-rounded">view_list</span>
              Open Positions
            </div>
            <div id="positionsList" class="positions-list">
              <p class="text-muted" style="font-style: italic;">No positions yet. Add your first opening to start sourcing talent.</p>
            </div>
          </div>
        </div>

        <div class="card-grid">
          <div class="md-card">
            <div class="card-title">
              <span class="material-symbols-rounded">person_add</span>
              Add Candidate
            </div>
            <form id="candidateForm" class="form-grid">
              <div class="md-field">
                <label class="md-label" for="candidatePositionSelect">Position</label>
                <div class="md-input-wrapper">
                  <span class="material-symbols-rounded">work</span>
                  <select id="candidatePositionSelect" name="positionId" class="md-select" required></select>
                </div>
              </div>
              <div class="md-field">
                <label class="md-label" for="candidateName">Candidate name</label>
                <div class="md-input-wrapper">
                  <span class="material-symbols-rounded">badge</span>
                  <input id="candidateName" name="name" type="text" class="md-input" placeholder="Full name" required>
                </div>
              </div>
              <div class="md-field">
                <label class="md-label" for="candidateContact">Contact details</label>
                <div class="md-input-wrapper">
                  <span class="material-symbols-rounded">call</span>
                  <input id="candidateContact" name="contact" type="text" class="md-input" placeholder="Email or phone" required>
                </div>
              </div>
              <div class="md-field">
                <label class="md-label" for="candidateCv">Upload CV</label>
                <input id="candidateCv" name="cv" type="file" accept=".pdf,.doc,.docx,.docm,.rtf" required>
                <p id="candidateCvHelpText" class="text-muted" style="margin-top:4px;">Accepted formats: PDF or Word documents.</p>
              </div>
              <div class="form-actions">
                <button id="candidateSubmitBtn" type="submit" class="md-button md-button--filled">
                  <span id="candidateSubmitIcon" class="material-symbols-rounded">upload_file</span>
                  <span class="candidate-submit-label">Add to Pipeline</span>
                </button>
                <button id="candidateCancelEditBtn" type="button" class="md-button md-button--text hidden">
                  <span class="material-symbols-rounded">close</span>
                  Cancel Edit
                </button>
              </div>
            </form>
          </div>

          <div class="md-card" style="overflow-x:auto;">
            <div class="card-title">
              <span class="material-symbols-rounded">timeline</span>
              Candidate Pipeline
            </div>
            <table class="data-table">
              <thead>
                <tr>
                  <th>Candidate</th>
                  <th>Contact</th>
                  <th>Status</th>
                  <th class="candidate-actions-header">Actions</th>
                </tr>
              </thead>
              <tbody id="candidateTableBody">
                <tr>
                  <td colspan="4" class="text-muted" style="padding:16px; font-style: italic;">Select a position to view candidates.</td>
                </tr>
              </tbody>
            </table>
          </div>

        </div>
      </section>

      <div id="candidateDetailsModal" class="modal-backdrop hidden">
        <div class="modal-card candidate-details-modal">
          <button type="button" id="candidateDetailsCloseBtn" class="modal-close material-symbols-rounded">close</button>
          <h3 class="modal-title">
            <span class="material-symbols-rounded">person</span>
            Candidate 365 View
          </h3>
          <div class="candidate-details-grid">
            <div class="candidate-details-column candidate-details-column--info">
              <div class="candidate-details-summary">
                <div class="candidate-details-section">
                  <div class="candidate-details-label">Candidate</div>
                  <div id="candidateDetailsName" class="candidate-details-value">-</div>
                </div>
                <div class="candidate-details-section">
                  <div class="candidate-details-label">Contact</div>
                  <div id="candidateDetailsContact" class="candidate-details-value">-</div>
                </div>
                <div class="candidate-details-section">
                  <div class="candidate-details-label">Status</div>
                  <div id="candidateDetailsStatus" class="candidate-details-value">-</div>
                </div>
                <div class="candidate-details-section">
                  <div class="candidate-details-label">Created</div>
                  <div id="candidateDetailsCreated" class="candidate-details-value">-</div>
                </div>
              </div>
              <div class="candidate-comments-panel">
                <div class="candidate-comments-header">
                  <div>
                    <div class="candidate-comments-title">Team Comments</div>
                    <div id="candidateDetailsCommentsMeta" class="candidate-comments-meta text-muted">Share feedback with your hiring team.</div>
                  </div>
                  <span id="candidateDetailsCommentsCount" class="candidate-comments-count">0</span>
                </div>
                <div id="commentsList" class="comments-list text-muted">
                  <p style="font-style: italic;">Select a candidate to load comments.</p>
                </div>
                <form id="commentForm" class="candidate-comments-form">
                  <label class="md-label" for="commentText">Add a comment</label>
                  <textarea id="commentText" class="md-textarea" rows="3" placeholder="Share feedback or interview notes" required></textarea>
                  <button id="commentSubmitBtn" type="submit" class="md-button md-button--filled md-button--small">
                    <span class="material-symbols-rounded">add_comment</span>
                    <span class="comment-submit-label">Add Comment</span>
                  </button>
                </form>
              </div>
            </div>
            <div class="candidate-details-column candidate-details-column--preview">
              <div class="candidate-cv-panel">
                <div class="candidate-cv-header">
                  <div>
                    <div class="candidate-cv-title">CV Preview</div>
                    <div id="candidateDetailsCvFilename" class="candidate-cv-filename text-muted">-</div>
                  </div>
                  <button type="button" id="candidateDetailsDownloadBtn" class="md-button md-button--tonal">
                    <span class="material-symbols-rounded">download</span>
                    Download CV
                  </button>
                </div>
                <div id="candidateCvPreview" class="candidate-cv-preview">
                  <div id="candidateCvPreviewMessage" class="cv-preview-message">Select a candidate to view their CV.</div>
                  <iframe id="candidateCvIframe" class="cv-preview-frame hidden" title="Candidate CV preview" frameborder="0"></iframe>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="candidateHireModal" class="modal-backdrop hidden">
        <div class="modal-card modal-card--wide">
          <button type="button" id="candidateHireCloseBtn" class="modal-close material-symbols-rounded">close</button>
          <h3 id="candidateHireTitle" class="modal-title">
            <span class="material-symbols-rounded">badge</span>
            <span id="candidateHireTitleText">Complete Employee Record</span>
          </h3>
          <p id="candidateHireSubtitle" class="text-muted" style="margin: -8px 0 4px;">
            Provide the mandatory employee information before marking this candidate as hired.
          </p>
          <form id="candidateHireForm" class="form-grid modal-body-scroll">
            <div id="candidateHireFields"></div>
          </form>
          <div class="modal-actions">
            <button type="button" id="candidateHireCancelBtn" class="md-button md-button--text md-button--small">Cancel</button>
            <button type="submit" form="candidateHireForm" class="md-button md-button--filled md-button--small">
              <span class="material-symbols-rounded">save</span>
              Save &amp; Mark Hired
            </button>
          </div>
        </div>
      </div>

      <div id="candidateCvModal" class="modal-backdrop hidden" role="dialog" aria-modal="true" aria-labelledby="candidateCvModalTitle">
        <div class="modal-card modal-card--wide candidate-cv-modal">
          <button type="button" id="candidateCvModalCloseBtn" class="modal-close material-symbols-rounded" aria-label="Close CV preview">close</button>
          <h3 id="candidateCvModalTitle" class="modal-title">
            <span class="material-symbols-rounded">picture_as_pdf</span>
            <span id="candidateCvModalTitleText">CV Preview</span>
          </h3>
          <div class="candidate-cv-modal__body">
            <p id="candidateCvModalMessage" class="candidate-cv-modal__message text-muted">Select a candidate to preview their CV.</p>
            <iframe id="candidateCvModalIframe" class="candidate-cv-modal__iframe hidden" title="Candidate CV preview"></iframe>
          </div>
          <div class="modal-actions">
            <button type="button" id="candidateCvModalDownloadBtn" class="md-button md-button--outlined md-button--small hidden">
              <span class="material-symbols-rounded">download</span>
              Download CV
            </button>
          </div>
        </div>
      </div>

      <!-- Manager Applications Panel -->
      <section id="managerAppsPanel" class="panel hidden">
        <div class="panel-header">
          <h2 class="panel-title">
            <span class="material-symbols-rounded">approval_delegation</span>
            Pending Leave Applications
          </h2>
          <p class="panel-subtitle">Review requests, add remarks, and take action swiftly.</p>
        </div>

        <div id="managerAppsList" class="list-stack"></div>

        <div class="md-card highlight-card">
          <div class="card-title">
            <span class="material-symbols-rounded">today</span>
            On Leave Today
          </div>
          <div id="onLeaveTodayList"></div>
        </div>

        <div class="md-card">
          <div class="card-title">
            <span class="material-symbols-rounded">calendar_clock</span>
            Upcoming Approved Leaves (Next 30 Days)
          </div>
          <div id="managerUpcomingList"></div>
        </div>
      </section>

      <!-- Leave Report Panel -->
      <section id="leaveReportPanel" class="panel hidden">
        <div class="panel-header">
          <h2 class="panel-title">
            <span class="material-symbols-rounded">insights</span>
            Leave Report
          </h2>
          <p class="panel-subtitle">Export snapshots, explore calendar activity, and track leave totals.</p>
        </div>

        <div class="list-card__actions" style="justify-content:flex-start;">
          <button id="exportLeavesBtn" class="md-button md-button--outlined">
            <span class="material-symbols-rounded">file_download</span>
            Export Leaves
          </button>
        </div>

        <div class="md-card" style="overflow-x:auto;">
          <table id="leaveReportTable" class="data-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Title</th>
                <th>Location</th>
                <th>Total Days</th>
                <th>Breakdown</th>
              </tr>
            </thead>
            <tbody id="leaveReportBody"></tbody>
          </table>
        </div>

        <div id="calendarSection">
          <div class="calendar-controls">
            <button id="calPrev" class="md-button md-button--text md-button--small">
              <span class="material-symbols-rounded">chevron_left</span>
              Previous
            </button>
            <h3 id="calMonth" class="panel-title" style="font-size:1.1rem;"></h3>
            <button id="calNext" class="md-button md-button--text md-button--small">
              Next
              <span class="material-symbols-rounded">chevron_right</span>
            </button>
          </div>
          <div id="calendarHeader" class="calendar-grid">
            <div class="text-muted">Sun</div>
            <div class="text-muted">Mon</div>
            <div class="text-muted">Tue</div>
            <div class="text-muted">Wed</div>
            <div class="text-muted">Thu</div>
            <div class="text-muted">Fri</div>
            <div class="text-muted">Sat</div>
          </div>
          <div id="leaveCalendar" class="calendar-grid"></div>
        </div>

        <div class="range-actions">
          <label>
            Start
            <input type="date" id="reportStart">
          </label>
          <label>
            End
            <input type="date" id="reportEnd">
          </label>
          <button id="reportApply" class="md-button md-button--filled md-button--small">
            <span class="material-symbols-rounded">tune</span>
            Apply
          </button>
          <button id="reportWeek" class="md-button md-button--outlined md-button--small">Past Week</button>
          <button id="reportMonth" class="md-button md-button--outlined md-button--small">Past 30 Days</button>
        </div>

        <div id="leaveRangeCards"></div>
      </section>

      <!-- Settings Panel -->
      <section id="settingsPanel" class="panel hidden">
        <div class="panel-header">
          <h2 class="panel-title">
            <span class="material-symbols-rounded">settings</span>
            Settings
          </h2>
          <p class="panel-subtitle">Configure company holidays to ensure accurate leave balances.</p>
        </div>

        <div class="md-card">
          <div class="card-title">
            <span class="material-symbols-rounded">calendar_month</span>
            Holiday Calendar
          </div>
          <p class="card-subtitle">Add official days off so applied leaves on these dates won't deduct balances.</p>
          <form id="holidayForm" class="settings-form">
            <div class="settings-form__fields">
              <label class="md-label" for="holidayDate">Holiday date</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">event</span>
                <input type="date" id="holidayDate" class="md-input" required>
              </div>
            </div>
            <div class="settings-form__fields">
              <label class="md-label" for="holidayName">Holiday name</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">celebration</span>
                <input type="text" id="holidayName" class="md-input" placeholder="e.g., Founders' Day" required>
              </div>
            </div>
            <button type="submit" class="md-button md-button--filled md-button--small settings-form__submit">
              <span class="material-symbols-rounded">add</span>
              Add Holiday
            </button>
          </form>
          <div id="holidayList" class="holiday-list"></div>
        </div>

        <div class="md-card">
          <div class="card-title">
            <span class="material-symbols-rounded">mail</span>
            Email Notifications
          </div>
          <p class="card-subtitle">Configure SMTP details for leave updates. Includes quick setup for Microsoft 365 / Office 365 mailboxes.</p>
          <form id="emailSettingsForm" class="settings-form">
            <div class="settings-form__toggle">
              <input type="checkbox" id="emailEnabled">
              <label for="emailEnabled" class="md-label">Enable email notifications</label>
            </div>
            <div class="settings-form__fields">
              <label class="md-label" for="emailProvider">Email provider</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">alternate_email</span>
                <select id="emailProvider" class="md-input">
                  <option value="custom">Custom SMTP</option>
                  <option value="office365">Microsoft 365 / Office 365</option>
                </select>
              </div>
            </div>
            <div class="settings-form__fields">
              <label class="md-label" for="emailAuthType">Authentication method</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">vpn_key</span>
                <select id="emailAuthType" class="md-input">
                  <option value="basic">Username &amp; password (LOGIN)</option>
                  <option value="oauth2">Microsoft OAuth 2.0 (modern auth)</option>
                </select>
              </div>
            </div>
            <div class="settings-form__fields">
              <label class="md-label" for="emailHost">SMTP host</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">dns</span>
                <input type="text" id="emailHost" class="md-input" placeholder="smtp.example.com">
              </div>
            </div>
            <div class="settings-form__fields settings-form__fields--compact">
              <label class="md-label" for="emailPort">Port</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">123</span>
                <input type="number" id="emailPort" class="md-input" min="1" max="65535" step="1" placeholder="587">
              </div>
            </div>
            <div class="settings-form__toggle settings-form__toggle--inline">
              <input type="checkbox" id="emailSecure">
              <label for="emailSecure" class="md-label">Use SSL/TLS (port 465)</label>
            </div>
            <div class="settings-form__fields">
              <label class="md-label" for="emailUser">SMTP username / sender</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">person</span>
                <input type="text" id="emailUser" class="md-input" placeholder="user@example.com">
              </div>
            </div>
            <div class="settings-form__fields auth-section auth-section--basic">
              <label class="md-label" for="emailPassword">SMTP password</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">lock</span>
                <input type="password" id="emailPassword" class="md-input" autocomplete="new-password" placeholder="Enter password">
              </div>
            </div>
            <div class="settings-form__fields auth-section auth-section--oauth hidden">
              <label class="md-label" for="emailOAuthTenant">Azure AD tenant ID / domain</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">apartment</span>
                <input type="text" id="emailOAuthTenant" class="md-input" placeholder="contoso.onmicrosoft.com or GUID">
              </div>
            </div>
            <div class="settings-form__fields auth-section auth-section--oauth hidden">
              <label class="md-label" for="emailOAuthClientId">Application (client) ID</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">apps</span>
                <input type="text" id="emailOAuthClientId" class="md-input" placeholder="00000000-0000-0000-0000-000000000000">
              </div>
            </div>
            <div class="settings-form__fields auth-section auth-section--oauth hidden">
              <label class="md-label" for="emailOAuthScope">OAuth scope</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">public</span>
                <input type="text" id="emailOAuthScope" class="md-input" placeholder="https://outlook.office365.com/.default">
              </div>
            </div>
            <div class="settings-form__fields auth-section auth-section--oauth hidden">
              <label class="md-label" for="emailOAuthClientSecret">Client secret</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">key</span>
                <input type="password" id="emailOAuthClientSecret" class="md-input" autocomplete="new-password" placeholder="Enter client secret">
              </div>
            </div>
            <div class="settings-form__fields settings-form__fields--full auth-section auth-section--oauth hidden">
              <label class="md-label" for="emailOAuthRefreshToken">Refresh token (optional)</label>
              <div class="md-input-wrapper md-input-wrapper--textarea">
                <span class="material-symbols-rounded">sync</span>
                <textarea id="emailOAuthRefreshToken" class="md-input md-input--textarea" rows="3" placeholder="Paste a delegated refresh token to send as a specific mailbox"></textarea>
              </div>
            </div>
            <div class="settings-form__fields">
              <label class="md-label" for="emailFrom">From address</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">outgoing_mail</span>
                <input type="email" id="emailFrom" class="md-input" placeholder="notifications@example.com">
              </div>
            </div>
            <div class="settings-form__fields">
              <label class="md-label" for="emailReplyTo">Reply-to (optional)</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">reply</span>
                <input type="email" id="emailReplyTo" class="md-input" placeholder="hr@example.com">
              </div>
            </div>
            <div class="settings-form__fields settings-form__fields--full">
              <span class="md-label">Notification recipients</span>
              <div id="emailRecipients" class="email-recipient-list"></div>
            </div>
            <div class="settings-form__help" id="emailRecipientsHelp">Select which managers should receive leave notification emails.</div>
            <div class="settings-form__help" id="emailPasswordHelp">Password is stored securely. Leave blank to keep the current password.</div>
            <div class="settings-form__help auth-section auth-section--oauth hidden" id="emailOAuthClientSecretHelp">Client secret is stored securely. Leave blank to keep the current value.</div>
            <div class="settings-form__help auth-section auth-section--oauth hidden" id="emailOAuthRefreshTokenHelp">Provide a refresh token only if using delegated permissions. Leave blank to keep the current value.</div>
            <button type="submit" class="md-button md-button--filled md-button--small settings-form__submit">
              <span class="material-symbols-rounded">save</span>
              Save email settings
            </button>
          </form>
          <div id="emailSettingsStatus" class="settings-status text-muted"></div>
        </div>

        <div class="md-card">
          <div class="card-title">
            <span class="material-symbols-rounded">terminal</span>
            API Testing Tools
          </div>
          <p class="card-subtitle">Open a guided test page to exercise the authentication flow and protected endpoints.</p>
          <a href="api-testing.html" target="_blank" class="md-button md-button--outlined md-button--small" rel="noreferrer">
            <span class="material-symbols-rounded">open_in_new</span>
            Open API Testing Sandbox
          </a>
          <ol class="settings-help-list">
            <li>Use the sandbox to authenticate with <code>/login</code> and capture the bearer token.</li>
            <li>Send the token along with requests to protected routes such as <code>/api/me</code>.</li>
            <li>Copy the generated <code>curl</code> command to share with third parties embedding the widget.</li>
          </ol>
        </div>
      </section>

      <section id="financePanel" class="panel hidden">
        <div class="panel-header">
          <h2 class="panel-title">
            <span class="material-symbols-rounded">account_balance</span>
            Finance
          </h2>
          <p class="panel-subtitle">Manage salary records for active employees and review payroll by month.</p>
        </div>

        <div class="md-card finance-controls-card">
          <div class="finance-controls">
            <div class="finance-month-field">
              <label class="md-label" for="financeMonth">Payroll Month</label>
              <div class="md-input-wrapper">
                <span class="material-symbols-rounded">calendar_month</span>
                <input type="month" id="financeMonth" class="md-input">
              </div>
            </div>
            <button id="financeRefresh" class="md-button md-button--tonal md-button--small">
              <span class="material-symbols-rounded">refresh</span>
              Refresh
            </button>
          </div>
          <p class="card-subtitle">Select a month to review payroll details. Salaries entered below apply across months.</p>
        </div>

        <section id="active-employees" class="active-employees-section">
          <div class="active-employees-header">
            <div>
              <h2 class="active-employees-title">Active Employees</h2>
              <p class="active-employees-subtitle">
                Enter the gross salary for each employee (applies to all months) and save your updates.
              </p>
            </div>

            <div class="employee-search-wrapper">
              <label for="employee-search" class="employee-search-label">
                Search Employee
              </label>
              <div class="employee-search-input-wrapper">
                <span class="employee-search-icon">🔍</span>
                <input
                  id="employee-search"
                  type="text"
                  placeholder="Type a name..."
                  class="employee-search-input"
                />
              </div>
            </div>
          </div>

          <div id="employee-cards" class="employee-cards"></div>
          <div
            id="financeEmptyState"
            class="hidden mt-4 rounded-xl border border-dashed border-slate-200 bg-slate-50 px-4 py-6 text-center text-sm text-slate-500"
          >
            <p>All active employees will appear here when available.</p>
          </div>
        </section>

        <section id="payrollSummarySection" class="payroll-summary-section">
          <div class="payroll-summary-container">
            <div class="payroll-summary-header">
              <div>
                <h2 class="payroll-summary-title">Payroll Summary</h2>
                <p class="payroll-summary-subtitle">
                  Monthly payroll overview with salary and bank account details.
                </p>
              </div>
              <div class="payroll-summary-actions">
                <div class="payroll-summary-month">
                  <span class="material-symbols-rounded">calendar_month</span>
                  <span id="payrollSummaryMonth"></span>
                </div>
                <button id="payrollExport" class="md-button md-button--filled md-button--small payroll-export-button">
                  <span class="material-symbols-rounded">file_download</span>
                  Export XLSX
                </button>
              </div>
            </div>

            <div class="payroll-summary-table-wrapper payroll-table-wrapper">
              <table class="payroll-summary-table payroll-table">
                <thead>
                  <tr>
                    <th>Employee</th>
                    <th>Salary (MMK)</th>
                    <th>Bank Account Name</th>
                    <th>Bank Account Number</th>
                  </tr>
                </thead>
                <tbody id="payrollSummaryBody"></tbody>
              </table>
            </div>
            <div id="payrollSummaryEmpty" class="payroll-summary-empty hidden">
              Payroll summary will appear once salary data is available.
            </div>
          </div>
        </section>
      </section>
    </main>
  </div>

  <div id="toastContainer" class="toast-container" aria-live="polite" aria-atomic="true"></div>

  <script>
    function toggleHalfDayPeriod() {
      const checkbox = document.getElementById('halfDay');
      const period = document.getElementById('halfDayPeriod');
      if (checkbox && period) {
        period.classList.toggle('hidden', !checkbox.checked);
      }
    }
  </script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js" integrity="sha256-DqnjmPNtI6D3NiAub4dkAAfkBpocQUTzM0hjtCqYLgA=" crossorigin="anonymous"></script>
  <script src="index.js"></script>
  
<iframe
  id="chatWidgetIframe"
  src="https://qa.atenxion.ai/chat-widget?agentchainId=6900712037c0ed036821b334"
  style="position:fixed; right:16px; bottom:16px; width:360px; height:720px; z-index:9999; border:0; border-radius:12px;"
  allow="microphone; camera; geolocation; display-capture; encrypted-media"
  title="Atenxion Chat">
</iframe>
  
</body>
</html>
